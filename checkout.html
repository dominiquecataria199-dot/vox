 <!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Terminal de Règlement | VOX MASTERY</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.13.3/dist/cdn.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Manrope:wght@300;400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- SDK PAIEMENTS -->
    <script src="https://www.paypal.com/sdk/js?client-id=AYdbiOBrS1LfLCWhleavJP0U94wSEARnYj_HO-VGRCqDeMIh2HDDupr6ll4qfiZBXxxjYg8ioIkKEyqb&currency=USD"></script>
    <script src="https://cdn.fedapay.com/checkout.js?v=1.1.7"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { heading: ['Bebas Neue', 'sans-serif'], body: ['Manrope', 'sans-serif'] },
                    colors: { void: '#0A0A0A', paper: '#111111', neon: '#6366f1', accent: '#a855f7' }
                }
            }
        }
    </script>
    <style>
        [x-cloak] { display: none !important; }
        .glass-panel { background: rgba(20, 20, 20, 0.7); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.08); }
        .glow-button { box-shadow: 0 0 20px rgba(99, 102, 241, 0.4); }
        .step-active { color: #6366f1; border-bottom: 2px solid #6366f1; }
        .method-card { transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        .method-card.selected { border-color: #6366f1; background: rgba(99, 102, 241, 0.05); transform: translateY(-2px); }
    </style>
</head>

<body class="bg-void text-gray-200 font-body antialiased min-h-screen flex flex-col overflow-x-hidden" x-data="paymentSystem()">

    <!-- HEADER MINIMALISTE -->
    <header class="py-6 px-8 flex justify-between items-center border-b border-white/5 bg-void/50 backdrop-blur-md sticky top-0 z-50">
        <div class="font-heading text-2xl tracking-[0.2em] text-white">VOX MASTERY</div>
        <div class="hidden md:flex gap-8 text-[10px] font-mono uppercase tracking-[0.3em] text-gray-500">
            <span :class="!success ? 'step-active' : ''" class="pb-1">01. Identification</span>
            <span :class="success ? 'step-active' : ''" class="pb-1">02. Activation</span>
        </div>
        <div class="flex items-center gap-2 text-[10px] text-neon font-mono uppercase border border-neon/30 px-3 py-1 rounded-full">
            <span class="w-1.5 h-1.5 bg-neon rounded-full animate-pulse"></span> Terminal Sécurisé
        </div>
    </header>

    <main class="flex-grow flex items-center justify-center p-6 relative">
        <!-- Ambiance visuelle -->
        <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-neon/5 rounded-full blur-[150px] pointer-events-none"></div>

        <div class="max-w-6xl w-full grid lg:grid-cols-12 gap-12 items-start relative z-10">
            
            <!-- GAUCHE : RÉCAPITULATIF EXÉCUTIF (5 COL) -->
            <div class="lg:col-span-5 space-y-8">
                <div class="glass-panel p-8 rounded-xl">
                    <h2 class="font-heading text-4xl text-white mb-8 tracking-tight">VOTRE ADMISSION</h2>
                    
                    <div class="space-y-6">
                        <div class="flex gap-4">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 flex items-center justify-center text-neon">
                                <i class="fa-solid fa-award"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-bold text-sm">Programme Mentoring 2026</h3>
                                <p class="text-gray-500 text-xs mt-1">Accès complet • Coaching individuel</p>
                            </div>
                        </div>

                        <div class="flex gap-4 border-t border-white/5 pt-6">
                            <div class="w-10 h-10 rounded-lg bg-neon/10 flex items-center justify-center text-neon">
                                <i class="fa-solid fa-fingerprint"></i>
                            </div>
                            <div>
                                <h3 class="text-white font-bold text-sm">Analyse VPA & Diagnostic</h3>
                                <p class="text-gray-500 text-xs mt-1">Données biométriques archivées</p>
                            </div>
                        </div>

                        <div class="bg-white/5 p-6 rounded-lg mt-8">
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-500 text-[10px] uppercase font-bold tracking-widest">Total de l'investissement</span>
                                <span class="text-neon text-[10px] font-mono">TVA Incluse</span>
                            </div>
                            <div class="flex items-baseline gap-2">
                                <span class="text-white font-heading text-5xl">850.000</span>
                                <span class="text-gray-400 font-heading text-2xl">FCFA</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Garantie & Confiance -->
                <div class="px-4 space-y-4">
                    <div class="flex items-center gap-4 text-gray-500">
                        <i class="fa-solid fa-shield-halved text-xl"></i>
                        <p class="text-[11px] leading-relaxed">Paiement protégé par cryptage bancaire. Vos accès sont débloqués immédiatement après confirmation du réseau.</p>
                    </div>
                </div>
            </div>

            <!-- DROITE : TERMINAL DE TRANSACTION (7 COL) -->
            <div class="lg:col-span-7">
                <div class="bg-white rounded-2xl p-8 md:p-12 text-void shadow-[0_30px_100px_rgba(0,0,0,0.4)]">
                    <div class="text-center mb-10">
                        <h3 class="font-heading text-3xl mb-2 uppercase tracking-tight">Mode de règlement</h3>
                        <p class="text-gray-400 text-sm">Sélectionnez votre passerelle sécurisée</p>
                    </div>

                    <!-- GRILLE DE MÉTHODES -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-10">
                        <!-- FedaPay -->
                        <div @click="gateway = 'fedapay'" 
                             :class="gateway === 'fedapay' ? 'selected' : ''" 
                             class="method-card border-2 border-gray-100 p-6 rounded-xl flex flex-col items-center text-center group">
                            <div class="w-12 h-12 mb-4 flex items-center justify-center bg-gray-50 rounded-full group-hover:scale-110 transition-transform">
                                <i class="fa-solid fa-mobile-screen-button text-2xl text-gray-700"></i>
                            </div>
                            <span class="text-xs font-bold uppercase mb-1">Paiement Local</span>
                            <span class="text-[10px] text-gray-400 uppercase tracking-tighter">Wave, MTN, Orange, Moov</span>
                        </div>

                        <!-- PayPal -->
                        <div @click="gateway = 'paypal'" 
                             :class="gateway === 'paypal' ? 'selected' : ''" 
                             class="method-card border-2 border-gray-100 p-6 rounded-xl flex flex-col items-center text-center group">
                            <div class="w-12 h-12 mb-4 flex items-center justify-center bg-gray-50 rounded-full group-hover:scale-110 transition-transform">
                                <i class="fa-brands fa-paypal text-2xl text-blue-700"></i>
                            </div>
                            <span class="text-xs font-bold uppercase mb-1">Carte / PayPal</span>
                            <span class="text-[10px] text-gray-400 uppercase tracking-tighter">Visa, Mastercard, International</span>
                        </div>
                    </div>

                    <!-- IDENTIFICATION RAPPEL -->
                    <div class="mb-10 flex items-center gap-4 p-4 bg-gray-50 rounded-lg border border-gray-100">
                        <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm">
                            <i class="fa-solid fa-user-check text-neon"></i>
                        </div>
                        <div>
                            <p class="text-[10px] uppercase text-gray-400 font-bold">Dossier associé</p>
                            <p class="text-sm font-bold font-mono" x-text="email"></p>
                        </div>
                    </div>

                    <!-- ACTIONS -->
                    <div class="space-y-6">
                        <!-- PayPal Container -->
                        <div id="paypal-button-container" x-show="gateway === 'paypal'" class="animate-fadeIn"></div>
                        
                        <!-- FedaPay Button -->
                        <button x-show="gateway === 'fedapay'" @click="payWithFeda()" 
                            class="w-full bg-void text-white py-6 rounded-xl font-bold uppercase tracking-[0.2em] text-sm hover:bg-neon transition-all glow-button flex justify-center items-center gap-3">
                            <span x-show="!loading">Lancer la transaction</span>
                            <span x-show="loading"><i class="fa-solid fa-circle-notch fa-spin"></i> Traitement...</span>
                        </button>
                    </div>

                    <p class="text-center text-[10px] text-gray-400 mt-8 uppercase tracking-widest font-bold">
                        <i class="fa-solid fa-shield-virus mr-2"></i> Terminal de paiement certifié PCI-DSS
                    </p>
                </div>
            </div>
        </div>
    </main>

    <!-- ÉCRAN DE SUCCÈS IMMERSIF -->
    <div x-show="success" class="fixed inset-0 z-[100] flex items-center justify-center bg-void p-6" x-cloak x-transition>
        <div class="absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-neon/20 via-void to-void"></div>
        <div class="text-center relative z-10 animate-fadeIn">
            <div class="w-32 h-32 bg-neon/10 text-neon rounded-full flex items-center justify-center mx-auto mb-10 border border-neon/30 relative">
                <div class="absolute inset-0 rounded-full animate-ping bg-neon/20"></div>
                <i class="fa-solid fa-check text-5xl"></i>
            </div>
            <h2 class="text-white font-heading text-6xl mb-4 uppercase tracking-tighter">Ordre Validé</h2>
            <p class="text-gray-400 text-xl max-w-lg mx-auto mb-12 font-light">Bienvenue, {{Nom}}. Votre transformation commence maintenant. Consultez votre boîte mail pour vos accès prioritaires.</p>
            <button @click="window.location.href='/'" class="px-12 py-5 bg-white text-void font-bold uppercase text-xs tracking-widest hover:bg-neon hover:text-white transition-all shadow-2xl">
                Accéder à mon Dashboard
            </button>
        </div>
    </div>

    <script>
        function paymentSystem() {
            return {
                email: '',
                Nom: 'Leader', // Sera mis à jour si besoin via URL ou Airtable
                gateway: 'fedapay',
                loading: false,
                success: false,
                amount: 850000,
                WEBHOOK_MAKE: 'https://hook.eu1.make.com/q50cvrq1636zcg3xanqada7serxs6h15',

                init() {
                    const urlParams = new URLSearchParams(window.location.search);
                    this.email = urlParams.get('email') || '';
                    this.setupPayPal();
                },

                payWithFeda() {
                    this.loading = true;
                    FedaPay.init({
                        public_key: 'pk_live_7lvC3MGGdjrdWEXaRP1Dm3QD',
                        transaction: {
                            amount: this.amount,
                            description: 'Vox Mastery Executive 2026',
                            customer: { email: this.email }
                        },
                        onComplete: (res) => {
                            if(res.status === 'approved' || res.status.name === 'approved') {
                                this.handleFinalSuccess(res.id);
                            } else {
                                this.loading = false;
                            }
                        }
                    }).open();
                },

                setupPayPal() {
                    paypal.Buttons({
                        style: { layout: 'vertical', color: 'blue', shape: 'rect', label: 'pay', height: 55 },
                        createOrder: (data, actions) => {
                            return actions.order.create({
                                purchase_units: [{
                                    description: "Vox Mastery 2026 Executive",
                                    amount: { currency_code: 'USD', value: '1415.00' }
                                }]
                            });
                        },
                        onApprove: (data, actions) => {
                            return actions.order.capture().then((details) => {
                                this.handleFinalSuccess(details.id);
                            });
                        }
                    }).render('#paypal-button-container');
                },

                async handleFinalSuccess(trxId) {
                    this.loading = true;
                    try {
                        await fetch(this.WEBHOOK_MAKE, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({
                                email: this.email,
                                transactionId: trxId,
                                gateway: this.gateway,
                                status: 'PAID',
                                date: new Date().toISOString()
                            })
                        });
                        this.success = true;
                    } catch (e) {
                        alert("Paiement validé, mais erreur de lien CRM. Contactez-nous avec l'ID : " + trxId);
                    } finally {
                        this.loading = false;
                    }
                }
            }
        }
    </script>
</body>
</html>
